{% import_yaml "influxdb/defaults.yaml" as version_map %}

{# Get default settings for version #}
{% set defaults = version_map.get('0_9') %}

{##
Setup variable using grains['os_family'] based logic, only add key:values here
that differ from whats in defaults.yaml
##}

{% set os_family_map = salt['grains.filter_by']({
   'Debian': {},
   'RedHat': {},
  },
  grain="os_family",
  merge=salt['pillar.get']('influxdb:lookup'))
%}

{## Merge the os_family_map into default settings ##}
{% do defaults.influxdb.update(os_family_map) %}

{# Update settings defaults from pillar data #}
{% set influxdb_settings = salt['pillar.get'](
    'influxdb',
    default=defaults.influxdb,
    merge=True)
%}

# vi: set ft=sls :
